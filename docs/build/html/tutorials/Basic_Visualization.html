

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic Visualization for Polygons or Dots in Spatial Images/ Stitiched Images &mdash; SpatioloJI 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2d01f2b6" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2d01f2b6" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="../examples/index.html" />
    <link rel="prev" title="Integrate Scanpy into Spatiology Workflow" href="Scanpy_SpatioloJI.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SpatioloJI
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic_concepts.html">SpatioloJI Object Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#core-components">Core Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#component-details">Component Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#adata-anndata-object">adata (AnnData Object)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#cell-meta-dataframe">cell_meta (DataFrame)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#polygons-dataframe">polygons (DataFrame)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#fov-positions-dataframe">fov_positions (DataFrame)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#images-dictionary">images (Dictionary)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#integration-and-relationships">Integration and Relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#creating-a-spatioloji-object">Creating a SpatioloJI Object</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#from-individual-components">From Individual Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#from-files">From Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#from-pickle">From Pickle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#key-methods">Key Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#data-access">Data Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic_concepts.html#custom-data">Custom Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basic_concepts.html#summary">Summary</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CosMx</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#basic-tutorials">Basic Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="QC_filtering.html">Quality Control and Filtering for Raw Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="QC_filtering.html#Prepare-original-data">Prepare original data</a></li>
<li class="toctree-l4"><a class="reference internal" href="QC_filtering.html#Instantiation-of-Spatioloji_qc-object">Instantiation of Spatioloji_qc object</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Scanpy_SpatioloJI.html">Integrate Scanpy into Spatiology Workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Scanpy_SpatioloJI.html#Run-basic-workflow-of-Scanpy">Run basic workflow of Scanpy</a></li>
<li class="toctree-l4"><a class="reference internal" href="Scanpy_SpatioloJI.html#Imputation">Imputation</a></li>
<li class="toctree-l4"><a class="reference internal" href="Scanpy_SpatioloJI.html#Instantiate-SpatioloJI-object">Instantiate SpatioloJI object</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Basic Visualization for Polygons or Dots in Spatial Images/ Stitiched Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Plot">Plot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#advanced-tutorials">Advanced Tutorials</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul class="simple">
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">Data (data)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/data.html#spatial-object">Spatial Object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/data.html#SpatioloJI.data.Spatial_Object.Spatioloji"><code class="docutils literal notranslate"><span class="pre">Spatioloji</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/data.html#SpatioloJI.data.Spatial_Object.Spatioloji_qc"><code class="docutils literal notranslate"><span class="pre">Spatioloji_qc</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/pl.html">Plotting (pl)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/pl.html#plot-spatial-image">Plot Spatial Image</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.stitch_fov_images"><code class="docutils literal notranslate"><span class="pre">stitch_fov_images()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_global_polygon_by_features"><code class="docutils literal notranslate"><span class="pre">plot_global_polygon_by_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_global_polygon_by_categorical"><code class="docutils literal notranslate"><span class="pre">plot_global_polygon_by_categorical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_global_dot_by_features"><code class="docutils literal notranslate"><span class="pre">plot_global_dot_by_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_global_dot_by_categorical"><code class="docutils literal notranslate"><span class="pre">plot_global_dot_by_categorical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_local_polygon_by_categorical"><code class="docutils literal notranslate"><span class="pre">plot_local_polygon_by_categorical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_local_polygon_by_features"><code class="docutils literal notranslate"><span class="pre">plot_local_polygon_by_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_local_dots_by_categorical"><code class="docutils literal notranslate"><span class="pre">plot_local_dots_by_categorical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pl.html#SpatioloJI.pl.Plot_Spatial_Image.plot_local_dots_by_features"><code class="docutils literal notranslate"><span class="pre">plot_local_dots_by_features()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/tl.html">Tools (tl)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/tl.html#spatial-functions">Spatial Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.perform_neighbor_analysis"><code class="docutils literal notranslate"><span class="pre">perform_neighbor_analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_nearest_neighbor_distances"><code class="docutils literal notranslate"><span class="pre">calculate_nearest_neighbor_distances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_cell_density"><code class="docutils literal notranslate"><span class="pre">calculate_cell_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_ripleys_k"><code class="docutils literal notranslate"><span class="pre">calculate_ripleys_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_cross_k_function"><code class="docutils literal notranslate"><span class="pre">calculate_cross_k_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_j_function"><code class="docutils literal notranslate"><span class="pre">calculate_j_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_g_function"><code class="docutils literal notranslate"><span class="pre">calculate_g_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_pair_correlation_function"><code class="docutils literal notranslate"><span class="pre">calculate_pair_correlation_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_cell_type_correlation"><code class="docutils literal notranslate"><span class="pre">calculate_cell_type_correlation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_colocation_quotient"><code class="docutils literal notranslate"><span class="pre">calculate_colocation_quotient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_proximity_analysis"><code class="docutils literal notranslate"><span class="pre">calculate_proximity_analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_morisita_index"><code class="docutils literal notranslate"><span class="pre">calculate_morisita_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_quadrat_variance"><code class="docutils literal notranslate"><span class="pre">calculate_quadrat_variance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_spatial_entropy"><code class="docutils literal notranslate"><span class="pre">calculate_spatial_entropy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_hotspot_analysis"><code class="docutils literal notranslate"><span class="pre">calculate_hotspot_analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_spatial_autocorrelation"><code class="docutils literal notranslate"><span class="pre">calculate_spatial_autocorrelation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_kernel_density"><code class="docutils literal notranslate"><span class="pre">calculate_kernel_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_spatial_heterogeneity"><code class="docutils literal notranslate"><span class="pre">calculate_spatial_heterogeneity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_mark_correlation"><code class="docutils literal notranslate"><span class="pre">calculate_mark_correlation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_spatial_context"><code class="docutils literal notranslate"><span class="pre">calculate_spatial_context()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_network_statistics"><code class="docutils literal notranslate"><span class="pre">calculate_network_statistics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/tl.html#SpatioloJI.tl.Spatial_function.calculate_gene_spatial_autocorrelation"><code class="docutils literal notranslate"><span class="pre">calculate_gene_spatial_autocorrelation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/utils.html">Utilities (utils)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to SpatioloJI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#ways-to-contribute">Ways to Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#setting-up-your-development-environment">Setting Up Your Development Environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#development-workflow">Development Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#making-changes">Making Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#code-style">Code Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#submitting-changes">Submitting Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#documentation">Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#writing-docstrings">Writing Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#tutorials-and-examples">Tutorials and Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#testing">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#writing-tests">Writing Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/index.html#running-tests">Running Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#release-process">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog/index.html#version-0-2-0-2025-05-20">Version 0.2.0 (2025-05-20)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog/index.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog/index.html#fixed">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog/index.html#changed">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog/index.html#deprecated">Deprecated</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystem/index.html">Ji Universe Ecosystem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ecosystem/index.html#core-packages">Core Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ecosystem/index.html#spatioloji-core-foundation">SpatioloJI: Core Foundation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ecosystem/index.html#dimensionji-multidimensional-analysis">DimensionJI: Multidimensional Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ecosystem/index.html#communicoji-cell-cell-communication">CommunicoJI: Cell-Cell Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ecosystem/index.html#fusionji-image-transcriptome-integration">FusionJI: Image-Transcriptome Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ecosystem/index.html#encycloji-method-repository">EncycloJI: Method Repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ecosystem/index.html#resources">Resources</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SpatioloJI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">CosMx</a></li>
      <li class="breadcrumb-item active">Basic Visualization for Polygons or Dots in Spatial Images/ Stitiched Images</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/Basic_Visualization.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Basic-Visualization-for-Polygons-or-Dots-in-Spatial-Images/-Stitiched-Images">
<h1>Basic Visualization for Polygons or Dots in Spatial Images/ Stitiched Images<a class="headerlink" href="#Basic-Visualization-for-Polygons-or-Dots-in-Spatial-Images/-Stitiched-Images" title="Link to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">SpatioloJI</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">SJ</span>
</pre></div>
</div>
</div>
<section id="Plot">
<h2>Plot<a class="headerlink" href="#Plot" title="Link to this heading"></a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- Set up directory paths for original data/saved data
- Load SpatioloJI object from pickle file
- Obtain stitiched image
- Plot polygons
  - Categorical
  - Continuous
- Plot dots
  - Categorical
  - Continuous
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load pickle file</span>
<span class="n">data_read</span> <span class="o">=</span> <span class="s1">&#39;./test_data/&#39;</span> <span class="c1"># for raw data</span>
<span class="n">data_save</span> <span class="o">=</span> <span class="s1">&#39;./test_data/&#39;</span> <span class="c1"># for processed data or intermediate result</span>
<span class="n">analysis_save</span> <span class="o">=</span> <span class="s1">&#39;./test_analysis/&#39;</span> <span class="c1"># for plots</span>
<span class="n">sp_ji</span> <span class="o">=</span> <span class="n">SJ</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Spatioloji</span><span class="o">.</span><span class="n">from_pickle</span><span class="p">(</span><span class="n">data_save</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp_ji</span> <span class="o">=</span> <span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">stitch_fov_images</span><span class="p">(</span>
        <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
        <span class="n">fov_ids</span><span class="o">=</span><span class="n">fov_id</span><span class="p">,</span>
        <span class="n">flip_vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">save_path</span><span class="o">=</span><span class="n">analysis_save</span><span class="o">+</span><span class="s2">&quot;stitched_fovs.png&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;FOVs Stitched Image&quot;</span><span class="p">,</span>
        <span class="n">show_plot</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stitching 20 FOVs: [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22]
Detected FOV image dimensions: 5472 x 3648
Creating stitched image with dimensions: 29011 x 26415
Added FOV 1 at position (22633, 16716)
Added FOV 2 at position (17816, 9172)
Added FOV 4 at position (17794, 22344)
Added FOV 5 at position (12061, 22766)
Added FOV 6 at position (14844, 18300)
Added FOV 7 at position (6150, 22266)
Added FOV 8 at position (8911, 18300)
Added FOV 9 at position (3161, 18272)
Added FOV 10 at position (0, 12838)
Added FOV 11 at position (616, 8211)
Added FOV 12 at position (6411, 2883)
Added FOV 13 at position (6277, 9672)
Added FOV 14 at position (12155, 10322)
Added FOV 15 at position (12094, 3727)
Added FOV 16 at position (17838, 4200)
Added FOV 17 at position (23538, 3816)
Added FOV 18 at position (15288, 14205)
Added FOV 19 at position (9711, 14238)
Added FOV 21 at position (12133, 0)
Added FOV 22 at position (17816, 422)
Saved stitched image to ./test_analysis/stitched_fovs.png
Stitched image created successfully with 20 FOVs.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_global_polygon_by_features</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;Mean.PanCK&quot;</span><span class="p">,</span>  <span class="c1"># features in adata.obs</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Creating polygons for 25368 cells...
Saved figure to ./test_analysis/polygon_Mean.PanCK_global_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_5_1.png" src="../_images/tutorials_Basic_Visualization_5_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_5_2.png" src="../_images/tutorials_Basic_Visualization_5_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_global_polygon_by_categorical</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;big_cell_type&quot;</span><span class="p">,</span>  <span class="c1"># features in adata.obs</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:563: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  feature_subset = spatioloji_obj.adata.obs[[feature]]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Creating polygons for 25368 cells in 3 categories...
Saved figure to ./test_analysis/polygon_big_cell_type_categorical_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_6_2.png" src="../_images/tutorials_Basic_Visualization_6_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_6_3.png" src="../_images/tutorials_Basic_Visualization_6_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_global_dot_by_features</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;Mean.PanCK&quot;</span><span class="p">,</span>  <span class="c1"># features in adata.obs</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:564: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  feature_subset[&#39;cell&#39;] = spatioloji_obj.adata.obs[&#39;cell&#39;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Creating scatter plot for 25368 cells...
Saved figure to ./test_analysis/global_dot_mean.panck_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_7_2.png" src="../_images/tutorials_Basic_Visualization_7_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_7_3.png" src="../_images/tutorials_Basic_Visualization_7_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_global_dot_by_categorical</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;big_cell_type&quot;</span><span class="p">,</span>  <span class="c1"># features in adata.obs</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:782: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  grid_size = int(np.ceil(np.sqrt(n_plots)))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved figure to ./test_analysis/global_dot_big_cell_type_categorical_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_8_2.png" src="../_images/tutorials_Basic_Visualization_8_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_8_3.png" src="../_images/tutorials_Basic_Visualization_8_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_local_polygon_by_categorical</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;big_cell_type&quot;</span><span class="p">,</span>
    <span class="n">fov_ids</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;17&#39;</span><span class="p">],</span>  <span class="c1"># Only these FOVs</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>
    <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">edge_width</span><span class="o">=</span><span class="mf">0.3</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:1325: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  feature_subset[&#39;cell&#39;] = spatioloji_obj.adata.obs_names
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved figure to ./test_analysis/local_polygon_big_cell_type_categorical_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_9_2.png" src="../_images/tutorials_Basic_Visualization_9_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_9_3.png" src="../_images/tutorials_Basic_Visualization_9_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_local_polygon_by_features</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;Mean.PanCK&quot;</span><span class="p">,</span>
    <span class="n">fov_ids</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;17&#39;</span><span class="p">],</span>  <span class="c1"># Only these FOVs</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>
    <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
    <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">edge_width</span><span class="o">=</span><span class="mf">0.3</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:1657: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  coords = group[[&#39;x_local_px&#39;, &#39;y_local_px&#39;]].values
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:1789: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  legend_ncol : int, optional
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved figure to ./test_analysis/local_polygon_mean.panck_continuous_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_10_2.png" src="../_images/tutorials_Basic_Visualization_10_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_10_3.png" src="../_images/tutorials_Basic_Visualization_10_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_local_dots_by_categorical</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;big_cell_type&quot;</span><span class="p">,</span>  <span class="c1"># Column in adata.obs</span>
    <span class="n">fov_ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">,</span> <span class="s2">&quot;17&quot;</span><span class="p">],</span>    <span class="c1"># Specific FOVs to plot</span>
    <span class="n">background_img</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># Show FOV images in background</span>
    <span class="n">dot_size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>                <span class="c1"># Make dots larger</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>                  <span class="c1"># Make dots more opaque</span>
    <span class="n">grid_layout</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>         <span class="c1"># 2x2 grid of plots</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">analysis_save</span><span class="p">,</span>       <span class="c1"># Save to specific directory</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>                     <span class="c1"># Higher resolution for publication</span>
<span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:1966: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved figure to ./test_analysis/local_dots_big_cell_type_categorical_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_11_2.png" src="../_images/tutorials_Basic_Visualization_11_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_11_3.png" src="../_images/tutorials_Basic_Visualization_11_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SJ</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">plot_local_dots_by_features</span><span class="p">(</span>
    <span class="n">spatioloji_obj</span><span class="o">=</span><span class="n">sp_ji</span><span class="p">,</span>
    <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;Max.PanCK&quot;</span><span class="p">,</span>    <span class="c1"># Numeric feature in adata.obs</span>
    <span class="n">fov_ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">,</span><span class="s2">&quot;17&quot;</span><span class="p">],</span>     <span class="c1"># Selected FOVs only</span>
    <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>           <span class="c1"># Different colormap</span>
    <span class="n">dot_size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>            <span class="c1"># Force color scale range</span>
    <span class="n">figure_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>             <span class="c1"># Wider figures</span>
    <span class="n">figure_height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>             <span class="c1"># Taller figures</span>
    <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>          <span class="c1"># White edge on dots</span>
    <span class="n">edge_width</span><span class="o">=</span><span class="mf">0.2</span>              <span class="c1"># Thinner edges</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:2279: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/gynecoloji/Library/CloudStorage/OneDrive-IndianaUniversity/IU/project/adventure/Python_workdirectory/package/CCCI/spatial_ccc/core/Plot_Spatial_Image.py:2394: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saved figure to ./local_dots_max.panck_continuous_with_bg.png
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_12_2.png" src="../_images/tutorials_Basic_Visualization_12_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Basic_Visualization_12_3.png" src="../_images/tutorials_Basic_Visualization_12_3.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Scanpy_SpatioloJI.html" class="btn btn-neutral float-left" title="Integrate Scanpy into Spatiology Workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../examples/index.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, SpatioloJI Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>